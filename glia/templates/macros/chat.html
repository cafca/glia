{% import "macros/planet.html" as planet_macros %}
{% import "macros/star.html" as star_macros %}
{% import "macros/identity.html" as id_macros %}


{% macro chatline(star) %}
<li class="list-group-item">
  {{ star_macros.oneup(star) }}
  <span class="rk-chatline">
    {{ id_macros.identity(star.author) }}
    <a href="{{ url_for('web.star', id=star.id) }}">{{star.created|localtime|naturaltime}} </a>
    {{ star.text|markdown(autolink=True, no_intra_emphasis=True, space_headers=True, safelink=True, skip_html=True)|mentions(star) }}
  </span>
  <div>
  {% for tagp in star.tags %}<a href="{{ url_for('web.tag', name=tagp.planet.tag.name) }}">#{{ tagp.planet.title }}</a>&nbsp;{% endfor %}
</li>

{% for planet_assoc in star.attachments %}
<li class="list-group-item rk-chat-planet">
  {{ planet_macros.planet(planet_assoc.planet, scale=True, size='small') }}
</li>
{% endfor %}

{% endmacro %}


{% macro chat(map) %}

<ul class="list-group" id="rk-chat-lines">
  <li class="list-group-item text-center" id="rk-chat-more">
    <a class="btn btn-default" role="button" id="rk-chat-more-button" href="#" data-loading-text='<i class="fa fa-circle-o-notch fa-spin"></i>' >Load more</a>
  </li>
</ul>

<div class="panel-footer">
<form class="rk-create" class="form-inline" action="{{ url_for('web.create_star') }}" method="GET">
  <input type="hidden" name="starmap" value="{{ map.id }}" />
  <input id="rk-chat-parent" class="rk-create-parent" name="parent" type="hidden" value="" />
  <div>
    <span>&nbsp;</span>
    <div class="pull-right rk-create-counter"></div>
    <div class="rk-create-extend">
      <p>That's a lot of text! Do you want to make a long post? <input type="submit" class="btn btn-sm btn-primary" value="Yes, please"></p>
    </div>
  </div>
  <div class="form-group">
    <input class="rk-create-text" name="text" autocomplete="off" class="form-control input-sm" />
    <button id="rk-chat-submit" class="btn btn-sm btn-default rk-create-submit" disabled="disabled" class="btn btn-sm rk-chat-button" data-loading-text='<i class="fa fa-circle-o-notch fa-spin"></i>' autocomplete="off">Reply</button>
  </div>
</form>
</div>

{% endmacro%}
