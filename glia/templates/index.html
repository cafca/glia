{% extends "base.html" %}

{% import "macros/star.html" as star_macros %}
{% import "macros/identity.html" as id_macros %}

{% block content %}
<div class="row" id="rk-index">
  <div class="rk-toc panel panel-default col-sm-3 col-sm-push-8">
    <h1>RKTIK Today</h1>
    <div class="rk-toc-groups">
      {% for g in group_data %}
        <h3>
          {{ id_macros.group(g.group) }}
        </h3>
        <ul>
        {% for star in g.top_posts %}
          <li><a href="{{ url_for('.star', id=star.id) }}">{{ star.text }}</a></li>
        {% endfor %}
        </ul>
      {% endfor %}
    </div> <!-- ./ group list -->

    <form action="{{ url_for('.groups') }}" method="POST" class="form-inline">
      {{ groupform.hidden_tag() }}
      <span class="form-group>">
        <input name="name" type="text" value="" class="form-control" />
        {% if groupform.name.errors %} {{groupform.name.errors}} {% endif %}
      </span>
      <button type="submit" class="btn">Start Movement</button>
    </form>
    <h3>More Movements</h3>
      <ul>
      {% for group in more_groups %}
      <li>{{ id_macros.group(group) }} {{ group.description|default("", True) }}</li>
      {% endfor %}
      </ul>
    </p>
  </div> <!-- ./rktik-toc -->

  {% if top_posts|length > 0 %}
  <div class="rk-frontpage col-sm-7 col-sm-pull-2">
    {{ star_macros.star_lead(top_posts[0], controlled_personas) }}

    {% for star in top_posts[1:] %}
      {% if loop.index0 is divisibleby 4 %}<div class="row">{% endif %}
      {{ star_macros.star_box(star, controlled_personas) }}
      {% if loop.index is divisibleby 4 or loop.last %}</div>{% endif %}
    {% endfor %}
  </div> <!-- ./ row -->
  {% else %}
  <h1>Join some Movements >>></h1>
  {% endif %}

</div> <!-- ./ index -->
{% endblock %}
