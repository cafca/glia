{% extends "base.html" %}

{% import "macros/star.html" as star_macros %}
{% import "macros/identity.html" as id_macros %}

{% block content %}
<div class="row" id="rk-index">
  <div class="rk-toc panel panel-default col-sm-3 col-sm-push-8">
    {% if top_posts|length > 0 %}
      <div class="panel-body">
        <h3>Hot Stars</h3>
      </div>

      <ul class="list-group rk-toc-movements">
  <!--       {% for g in movement_data %}
          <h3>
            {{ id_macros.movement(g.movement) }}
          </h3>
          <ul>
          {% for star in g.top_posts %}
            <li><a href="{{ url_for('.star', id=star.id) }}">{{ star.text }}</a></li>
          {% endfor %}
          </ul>
        {% endfor %}
   -->
        {% for star in top_posts %}
        <li class="list-group-item"><a href="{{ url_for('web.star', id=star.id) }}">{{ star.text }}</li>
        {% endfor %}
      </ul> <!-- ./ movement list -->
    {% endif %}

    <div class="panel-body">
    {% if more_movements[:]|length() > 0 %}
    <h3>Discover Movements</h3>
      <ul>
      {% for movement in more_movements %}
      <li>{{ id_macros.movement(movement) }} {{ movement.description|default("", True) }}</li>
      {% endfor %}
      </ul>
    {% endif %}
    <a role="button" class="btn btn-default" href="{{ url_for('web.movements') }}">Start a Movement Today</a>
    </div>

  </div> <!-- ./rktik-toc -->

  {% if movement_data|length > 0 %}
    <div class="rk-frontpage col-sm-7 col-sm-pull-2">
    {% for m in movement_data %}
      <div class="panel panel-default">
        <div class="panel-body">
          <h1>{{ id_macros.movement(m.movement) }}</h1>
          <p><em>{{ m.movement.description }}</em></p>

          {% if m.top_posts|length > 0 %}
            {{ star_macros.star_lead(m.top_posts[0], controlled_personas) }}

            {% for star in top_posts[1:] %}
              {% if loop.index0 is divisibleby 4 %}<div class="row">{% endif %}
              {{ star_macros.star_box(star, controlled_personas) }}
              {% if loop.index is divisibleby 4 or loop.last %}</div>{% endif %}
            {% endfor %}
          {% endif %}
        </div>
      </div>
    {% endfor %}
    </div> <!-- ./ row -->
  {% else %}
  <h1>Join some Movements!</h1>
  {% endif %}

</div> <!-- ./ index -->
{% endblock %}
